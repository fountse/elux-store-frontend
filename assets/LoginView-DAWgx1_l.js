import{d as N,u as R,D as j,m as A,g,i as t,t as a,f as o,q as E,B as v,C as _,b as y,w,h as S,j as c,x as u,k as P,o as k,v as q,l as F}from"./index-Cf3Z8cN2.js";import{u as G}from"./user-DgN10sy1.js";import{u as H}from"./useTheme-BkzmY_NB.js";const I={class:"fixed inset-0 flex items-center justify-center bg-page px-4"},J={class:"max-w-md w-full p-8 bg-surface dark:bg-surface-secondary/50 rounded-none shadow-xl border border-transparent dark:border-white/10 transition-all duration-300"},K={class:"text-center mb-8"},Q={class:"text-3xl font-bold text-text-primary mb-2"},W={class:"text-text-secondary"},X={class:"block text-sm font-medium text-text-secondary mb-2"},Y={class:"flex justify-between items-center mb-2"},Z={class:"block text-sm font-medium text-text-secondary"},z={class:"block text-sm font-medium text-text-secondary mb-2"},O={class:"flex gap-4"},ee=["placeholder"],te={key:0,class:"text-error text-sm text-center"},oe=["disabled"],se={key:0,class:"animate-spin mr-2"},re={class:"mt-4 text-center space-y-3"},ae={class:"text-sm text-text-secondary"},ne={class:"mr-1"},le={class:"text-sm text-text-secondary"},ie={class:"mt-6 text-center text-sm text-text-secondary"},me=N({__name:"LoginView",setup(de){const{t:s}=R(),{theme:V}=H(),x=u(""),f=u(""),h=u(""),M=u(""),m=u(""),C=u(null),i=G(),T=F(),B=q(),p=()=>{const r=C.value;if(!r)return;const e=r.getContext("2d");if(!e)return;e.clearRect(0,0,r.width,r.height);const d="ABCDEFGHJKLMNPQRSTUVWXYZ23456789";let n="";for(let l=0;l<4;l++)n+=d.charAt(Math.floor(Math.random()*d.length));M.value=n;const b=document.documentElement.classList.contains("dark");e.fillStyle=b?"#2c2c2e":"#f5f5f5",e.fillRect(0,0,r.width,r.height),e.font="24px Arial",e.textAlign="center",e.textBaseline="middle";for(let l=0;l<n.length;l++){const U=20+l*25,$=25,D=(Math.random()-.5)*.4;e.save(),e.translate(U,$),e.rotate(D),b?e.fillStyle=`rgb(${155+Math.floor(Math.random()*100)}, ${155+Math.floor(Math.random()*100)}, ${155+Math.floor(Math.random()*100)})`:e.fillStyle=`rgb(${Math.floor(Math.random()*100)}, ${Math.floor(Math.random()*100)}, ${Math.floor(Math.random()*100)})`,e.fillText(n[l],0,0),e.restore()}e.strokeStyle=b?"#444":"#ddd";for(let l=0;l<5;l++)e.beginPath(),e.moveTo(Math.random()*r.width,Math.random()*r.height),e.lineTo(Math.random()*r.width,Math.random()*r.height),e.stroke()};j(V,()=>{setTimeout(p,50)}),A(()=>{p()});const L=async()=>{if(m.value="",!x.value||!f.value){m.value="Please fill in all fields";return}if(!h.value||h.value.toUpperCase()!==M.value){m.value=s("login.captcha_error"),p(),h.value="";return}if(await i.login(x.value,f.value)){const e=B.query.redirect||"/";T.push(e)}};return(r,e)=>{const d=P("router-link");return k(),g("div",I,[t("div",J,[t("div",K,[t("h1",Q,a(o(s)("login.welcome")),1),t("p",W,a(o(s)("login.subtitle")),1)]),t("form",{onSubmit:E(L,["prevent"]),class:"space-y-6"},[t("div",null,[t("label",X,a(o(s)("login.username")),1),v(t("input",{"onUpdate:modelValue":e[0]||(e[0]=n=>x.value=n),type:"text",class:"w-full bg-surface border border-border rounded-none px-4 py-3 text-text-primary placeholder:text-text-tertiary focus:border-text-primary focus:ring-0 focus:outline-none transition-colors",placeholder:"user or business"},null,512),[[_,x.value]])]),t("div",null,[t("div",Y,[t("label",Z,a(o(s)("login.password")),1),y(d,{to:"/forgot-password",class:"text-sm text-accent hover:text-accent-hover font-medium"},{default:w(()=>[c(a(o(s)("login.forgot_password")),1)]),_:1})]),v(t("input",{"onUpdate:modelValue":e[1]||(e[1]=n=>f.value=n),type:"password",class:"w-full bg-surface border border-border rounded-none px-4 py-3 text-text-primary placeholder:text-text-tertiary focus:border-text-primary focus:ring-0 focus:outline-none transition-colors",placeholder:"123456"},null,512),[[_,f.value]])]),t("div",null,[t("label",z,a(o(s)("login.captcha")),1),t("div",O,[v(t("input",{"onUpdate:modelValue":e[2]||(e[2]=n=>h.value=n),type:"text",class:"flex-1 bg-surface border border-border rounded-none px-4 py-3 text-text-primary placeholder:text-text-tertiary focus:border-text-primary focus:ring-0 focus:outline-none transition-colors",placeholder:o(s)("login.captcha")},null,8,ee),[[_,h.value]]),t("canvas",{ref_key:"captchaCanvas",ref:C,width:"120",height:"50",class:"cursor-pointer rounded-none border border-border",onClick:p,title:"Click to refresh"},null,512)])]),m.value||o(i).error?(k(),g("div",te,a(m.value||o(i).error),1)):S("",!0),t("button",{type:"submit",disabled:o(i).isLoading,class:"w-full bg-gray-900 dark:bg-[#2c2c2e] text-white dark:text-white font-bold py-3 rounded-none hover:bg-black dark:hover:bg-[#3e3e41] transition-all shadow-lg hover:shadow-xl hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed flex justify-center disabled:hover:translate-y-0 disabled:shadow-none"},[o(i).isLoading?(k(),g("span",se,"âšª")):S("",!0),c(" "+a(o(i).isLoading?o(s)("login.submitting"):o(s)("login.submit")),1)],8,oe),t("div",re,[t("div",ae,[t("span",ne,a(o(s)("login.no_account")),1),y(d,{to:"/register",class:"text-accent hover:text-accent-hover font-medium transition-colors"},{default:w(()=>[c(a(o(s)("login.register_now")),1)]),_:1})]),t("div",le,[y(d,{to:"/register/enterprise",class:"text-accent hover:text-accent-hover font-medium underline decoration-solid underline-offset-4 transition-colors"},{default:w(()=>[c(a(o(s)("register.register_business")),1)]),_:1})])])],32),t("div",ie,[t("p",null,a(o(s)("login.demo_credentials"))+":",1),e[3]||(e[3]=t("p",null,[c("User: "),t("span",{class:"text-text-primary"},"user / 123456")],-1)),e[4]||(e[4]=t("p",null,[c("Business: "),t("span",{class:"text-text-primary"},"business / 123456")],-1))])])])}}});export{me as default};

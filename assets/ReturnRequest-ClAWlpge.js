import{d as D,u as O,m as T,a as A,w as g,v as P,x as u,o as l,i as e,b as S,j as I,t,f as a,g as c,F as V,r as $,q as G,h as b,B as H,C as J,n as K,l as Q,K as W,c as X,k as Y}from"./index-BHA_9EEM.js";import{u as Z}from"./order-DP6Opxxr.js";import{P as ee}from"./PersonalCenterLayout-5SC6SseK.js";import{_ as te}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./cart-C8CNgBpq.js";import"./user-DU_8BvVJ.js";const se={class:"flex flex-col gap-8 w-full max-w-5xl mx-auto font-sans text-text-primary"},re={class:"flex justify-between items-center text-sm"},oe={class:"text-text-secondary tracking-wide"},ae={class:"text-text-primary"},ne={key:0,class:"space-y-8 animate-fade-in"},le={class:"border-b border-gray-200 dark:border-white/[0.02] pb-6"},de={class:"text-2xl font-bold mb-2"},ce={class:"text-text-secondary text-sm"},ie={class:"space-y-4"},ue={class:"text-lg font-bold"},_e={class:"bg-surface dark:bg-[#2c2c2e] border border-gray-200 dark:border-transparent rounded-lg overflow-hidden"},xe={class:"p-4 border-b border-gray-200 dark:border-white/[0.02] bg-surface-secondary dark:bg-black/20 flex items-center gap-4"},pe=["checked"],fe={class:"text-sm font-medium"},me={class:"divide-y divide-gray-200 dark:divide-white/[0.02]"},be=["onClick"],he=["checked","onChange"],ve={class:"w-20 h-20 bg-surface-secondary dark:bg-black/20 flex-shrink-0 rounded-md overflow-hidden border border-gray-200 dark:border-white/[0.02]"},ye=["src"],ge={class:"flex-grow flex justify-between items-start"},ke={class:"font-bold text-base"},we={key:0,class:"text-sm text-text-secondary mt-1"},qe={class:"text-right"},Ce={class:"text-sm font-bold"},Re={class:"text-sm text-text-secondary"},Se={key:0,class:"text-error text-sm"},Ie={class:"space-y-4"},Ve={class:"text-lg font-bold"},$e={class:"relative"},je=["placeholder"],Be={class:"flex flex-wrap gap-2"},ze=["onClick"],Le={key:0,class:"text-error text-sm"},Me={class:"flex justify-end gap-4 pt-6 border-t border-border"},Ne=["disabled"],Ee={key:0},Fe={key:1},Ue={key:1,class:"text-center py-20"},De={class:"text-text-secondary"},Oe={key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm animate-fade-in"},Te={class:"bg-surface rounded-2xl max-w-md w-full p-8 text-center shadow-2xl transform transition-all scale-100 border border-border"},Ae={class:"text-2xl font-bold mb-2 text-text-primary"},Pe={class:"text-text-secondary mb-8"},Ge=D({__name:"ReturnRequest",setup(He){const{t:s}=O(),j=P(),v=Q(),k=Z(),d=u(void 0),w=u(!0),h=u(!1),y=u(!1),i=u(new Set),_=W({reason:""}),x=u(""),f=u(""),B=["size","quality","wrong_item","changed_mind","damaged","other"],m=r=>`${r.productId}-${r.selectedVariant||""}`,q=X(()=>d.value?d.value.items.every(r=>i.value.has(m(r))):!1),z=r=>r,L=r=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(r),M=()=>{d.value&&(q.value?i.value.clear():d.value.items.forEach(r=>{i.value.add(m(r))}),x.value="")},C=r=>{const o=m(r);i.value.has(o)?i.value.delete(o):i.value.add(o),x.value=""},N=r=>i.value.has(m(r)),E=r=>{_.reason=s(`return_request.reasons.${r}`),f.value=""},F=async()=>{let r=!0;if(x.value="",f.value="",i.value.size===0&&(x.value=s("return_request.error_select"),r=!1),_.reason.trim()||(f.value=s("return_request.error_reason"),r=!1),!!r){h.value=!0;try{if(!d.value)return;const o=d.value.items.filter(p=>i.value.has(m(p)));await k.createReturnRequest(d.value.id,o,_.reason),y.value=!0}catch(o){console.error("Failed to submit return request",o),alert(s("return_request.fail_message"))}finally{h.value=!1}}},U=()=>{y.value=!1,v.push("/user/returns")};return T(async()=>{const r=j.params.id;if(r){let o=k.orders.find(p=>p.id===r);d.value=o}w.value=!1}),(r,o)=>{const p=Y("router-link");return l(),A(ee,{"bg-class":"bg-white"},{default:g(()=>[e("div",se,[e("div",re,[e("div",oe,[S(p,{to:"/",class:"hover:text-text-primary transition-colors"},{default:g(()=>[I(t(a(s)("nav.home")),1)]),_:1}),o[4]||(o[4]=e("span",{class:"mx-2"},"/",-1)),S(p,{to:"/user/orders",class:"hover:text-text-primary transition-colors"},{default:g(()=>[I(t(a(s)("sidebar.orders")),1)]),_:1}),o[5]||(o[5]=e("span",{class:"mx-2"},"/",-1)),e("span",ae,t(a(s)("return_request.title")),1)])]),d.value?(l(),c("div",ne,[e("div",le,[e("h1",de,t(a(s)("return_request.title")),1),e("p",ce,t(a(s)("order.no"))+": "+t(d.value.id),1)]),e("section",ie,[e("h2",ue,t(a(s)("return_request.select_items")),1),e("div",_e,[e("div",xe,[e("input",{type:"checkbox",checked:q.value,onChange:M,class:"w-4 h-4 rounded border-border text-text-primary focus:ring-text-primary bg-surface"},null,40,pe),e("span",fe,t(a(s)("return_request.select_all")),1)]),e("div",me,[(l(!0),c(V,null,$(d.value.items,n=>(l(),c("div",{key:n.productId+n.selectedVariant,class:"p-4 flex gap-4 items-start hover:bg-surface-secondary dark:hover:bg-white/5 transition-colors cursor-pointer",onClick:R=>C(n)},[e("div",{class:"pt-1",onClick:o[0]||(o[0]=G(()=>{},["stop"]))},[e("input",{type:"checkbox",checked:N(n),onChange:R=>C(n),class:"w-4 h-4 rounded border-gray-300 dark:border-white/20 text-text-primary focus:ring-text-primary bg-surface dark:bg-[#252525]"},null,40,he)]),e("div",ve,[e("img",{src:z(n.product.images[0]),class:"w-full h-full object-cover mix-blend-multiply dark:mix-blend-normal"},null,8,ye)]),e("div",ge,[e("div",null,[e("h3",ke,t(n.product.name),1),n.selectedVariant?(l(),c("p",we,t(a(s)("common.spec"))+": "+t(n.selectedVariant),1)):b("",!0)]),e("div",qe,[e("p",Ce,t(L(n.product.priceRetail)),1),e("span",Re,"x"+t(n.quantity),1)])])],8,be))),128))])]),x.value?(l(),c("p",Se,t(x.value),1)):b("",!0)]),e("section",Ie,[e("h2",Ve,t(a(s)("return_request.reason_title")),1),e("div",$e,[H(e("textarea",{"onUpdate:modelValue":o[1]||(o[1]=n=>_.reason=n),rows:"4",class:"w-full p-4 border border-gray-200 dark:border-transparent rounded-lg focus:ring-1 focus:ring-text-primary focus:border-text-primary outline-none resize-none bg-surface-secondary dark:bg-[#2c2c2e] text-text-primary placeholder-text-tertiary",placeholder:a(s)("return_request.reason_placeholder")},null,8,je),[[J,_.reason]])]),e("div",Be,[(l(),c(V,null,$(B,n=>e("button",{key:n,type:"button",onClick:R=>E(n),class:K(["px-3 py-1.5 rounded-full text-xs border transition-all duration-200",_.reason===a(s)(`return_request.reasons.${n}`)?"bg-surface-secondary dark:bg-white/10 text-text-primary border-text-secondary font-bold ring-1 ring-text-secondary":"bg-surface dark:bg-[#2c2c2e] text-text-secondary border-gray-200 dark:border-transparent hover:border-text-secondary"])},t(a(s)(`return_request.reasons.${n}`)),11,ze)),64))]),f.value?(l(),c("p",Le,t(f.value),1)):b("",!0)]),e("div",Me,[e("button",{onClick:o[2]||(o[2]=n=>a(v).back()),class:"px-8 py-3 rounded-lg font-medium text-text-secondary hover:text-text-primary hover:bg-surface-secondary/50 transition-colors"},t(a(s)("common.cancel")),1),e("button",{onClick:F,class:"px-8 py-3 rounded-lg font-bold shadow-sm btn-primary",disabled:h.value},[h.value?(l(),c("span",Ee,t(a(s)("return_request.processing")),1)):(l(),c("span",Fe,t(a(s)("return_request.submit_btn")),1))],8,Ne)])])):w.value?b("",!0):(l(),c("div",Ue,[e("p",De,t(a(s)("return_request.not_found")),1),e("button",{onClick:o[3]||(o[3]=n=>a(v).push("/user/orders")),class:"mt-4 text-text-primary underline"},t(a(s)("return_request.back_orders")),1)]))]),y.value?(l(),c("div",Oe,[e("div",Te,[o[6]||(o[6]=e("div",{class:"w-16 h-16 bg-success/10 rounded-full flex items-center justify-center mx-auto mb-6"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-8 h-8 text-success",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})])],-1)),e("h3",Ae,t(a(s)("return_request.success_title")),1),e("p",Pe,t(a(s)("return_request.success_desc")),1),e("button",{onClick:U,class:"w-full py-3 rounded-xl font-bold btn-primary"},t(a(s)("return_request.view_status")),1)])])):b("",!0)]),_:1})}}}),Ze=te(Ge,[["__scopeId","data-v-d0c2711e"]]);export{Ze as default};

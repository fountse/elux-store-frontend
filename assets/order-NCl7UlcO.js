import{C as h,x as l}from"./index-BQVMMhDG.js";import{u as f}from"./cart-Df4xEf9A.js";import{u as y}from"./user-Cbv6_bUs.js";const p="elux_orders_v5",m="elux_return_orders",d={async createOrder(t,r,s,e,o,c){return new Promise(i=>{setTimeout(()=>{const n={id:`ORD-${Date.now().toString().slice(-6)}`,items:[...t],totalAmount:r,userRole:s,status:"pending",createdAt:new Date().toISOString(),shippingAddress:e,billingAddress:o,paymentMethod:c},a=this.getOrdersFromLocal();a.unshift(n),localStorage.setItem(p,JSON.stringify(a)),i(n)},1e3)})},async getOrders(){return new Promise(t=>{setTimeout(()=>{t(this.getOrdersFromLocal())},500)})},async getOrderById(t){return new Promise(r=>{setTimeout(()=>{const s=this.getOrdersFromLocal();r(s.find(e=>e.id===t))},300)})},getOrdersFromLocal(){const t=localStorage.getItem(p);if(t){const s=JSON.parse(t);if(s.length>0)return s.map(e=>{const o=e.paymentMethod==="postpay"||e.id.endsWith("001")||e.id.endsWith("002")||e.id.endsWith("004")||e.id.endsWith("006");return!e.paymentMethod&&o&&(e.paymentMethod="postpay"),e.paymentStatus||(e.status==="delivered"||e.status==="shipped"?e.paymentStatus="paid":o&&(e.paymentStatus="unpaid")),e})}const r=R();return localStorage.setItem(p,JSON.stringify(r)),r},async createReturnRequest(t,r,s){return new Promise(e=>{setTimeout(()=>{const o=r.reduce((a,u)=>a+u.product.priceRetail*u.quantity,0),c=r.reduce((a,u)=>a+u.quantity,0),i={id:`RET-${Date.now().toString().slice(-6)}`,orderId:t,returnNo:`R${Date.now()}`,items:r,amount:o,quantity:c,status:"processing",createdAt:new Date().toISOString(),reason:s},n=this.getReturnRequestsFromLocal();n.unshift(i),localStorage.setItem(m,JSON.stringify(n)),e(i)},1e3)})},getReturnRequestsFromLocal(){const t=localStorage.getItem(m);if(t)return JSON.parse(t);const r=this.getOrdersFromLocal(),s=w(r);return s.length>0&&localStorage.setItem(m,JSON.stringify(s)),s}},O=()=>[{id:"1",name:"Cashmere Blend Sweater",priceRetail:129,priceWholesale:65,images:["https://images.unsplash.com/photo-1576566588028-4147f3842f27?q=80&w=1000&auto=format&fit=crop"],description:"Luxurious cashmere blend.",shortDescription:"Luxurious cashmere",minOrderQty:5,category:"Knitwear",tags:["New","Winter"],variants:[],features:[],specs:{}},{id:"2",name:"Structured Wool Blazer",priceRetail:249,priceWholesale:120,images:["https://images.unsplash.com/photo-1591047139829-d91aecb6caea?q=80&w=1000&auto=format&fit=crop"],description:"Perfect for office and casual wear.",shortDescription:"Office & casual",minOrderQty:5,category:"Blazers",tags:["Classic"],variants:[],features:[],specs:{}},{id:"3",name:"Silk Evening Dress",priceRetail:399,priceWholesale:180,images:["https://images.unsplash.com/photo-1595777457583-95e059d581b8?q=80&w=1000&auto=format&fit=crop"],description:"Elegant silk dress.",shortDescription:"Elegant silk",minOrderQty:3,category:"Dresses",tags:["Evening"],variants:[],features:[],specs:{}}],R=()=>{const t=O();return[{id:"ORD-2024001",items:[{productId:"1",product:t[0],quantity:2,selectedVariant:"M"},{productId:"3",product:t[2],quantity:1,selectedVariant:"S"}],totalAmount:657,userRole:"b2c",status:"pending",createdAt:new Date(Date.now()-1e3*60*60*2).toISOString(),shippingAddress:"123 Fashion St, New York, NY 10001"},{id:"ORD-2024002",items:[{productId:"2",product:t[1],quantity:2,selectedVariant:"L"},{productId:"1",product:t[0],quantity:3,selectedVariant:"S"},{productId:"3",product:t[2],quantity:1,selectedVariant:"M"}],totalAmount:1284,userRole:"b2c",status:"delivered",createdAt:new Date(Date.now()-1e3*60*60*24).toISOString(),shippingAddress:"123 Fashion St, New York, NY 10001"},{id:"ORD-2024003",items:[{productId:"3",product:t[2],quantity:2,selectedVariant:"S"},{productId:"2",product:t[1],quantity:1,selectedVariant:"M"}],totalAmount:1047,userRole:"b2c",status:"shipped",createdAt:new Date(Date.now()-1e3*60*60*48).toISOString(),shippingAddress:"123 Fashion St, New York, NY 10001"},{id:"ORD-2024004",items:[{productId:"2",product:t[1],quantity:1,selectedVariant:"M"}],totalAmount:249,userRole:"b2c",status:"delivered",createdAt:new Date(Date.now()-1e3*60*60*24*5).toISOString(),shippingAddress:"123 Fashion St, New York, NY 10001"},{id:"ORD-2024005",items:[{productId:"1",product:t[0],quantity:1,selectedVariant:"L"}],totalAmount:129,userRole:"b2c",status:"cancelled",createdAt:new Date(Date.now()-1e3*60*60*24*10).toISOString(),shippingAddress:"123 Fashion St, New York, NY 10001"},{id:"ORD-2024006",items:[{productId:"1",product:t[0],quantity:2,selectedVariant:"M"},{productId:"2",product:t[1],quantity:1,selectedVariant:"L"},{productId:"3",product:t[2],quantity:3,selectedVariant:"S"}],totalAmount:1704,userRole:"b2c",status:"pending",createdAt:new Date(Date.now()-1e3*60*30).toISOString(),shippingAddress:"456 Style Ave, Los Angeles, CA 90001"}]},w=t=>{const r=t.find(s=>s.status==="delivered");return r?[{id:"RET-2024001",orderId:r.id,returnNo:"R2024001",items:r.items,amount:r.totalAmount,quantity:r.items.reduce((s,e)=>s+e.quantity,0),status:"processing",createdAt:new Date().toISOString(),reason:"Size too small",method:"Original Payment Method"}]:[]},A=h("order",()=>{const t=l([]),r=l([]),s=l(!1);t.value=d.getOrdersFromLocal(),r.value=d.getReturnRequestsFromLocal();async function e(c,i,n){const a=f(),u=y();if(a.items.length===0)return null;s.value=!0;try{const S=u.isB2B?"b2b":"b2c",g=await d.createOrder(a.items,a.total,S,c,i,n);return t.value.unshift(g),await a.clearCart(),g}finally{s.value=!1}}async function o(c,i,n){s.value=!0;try{const a=await d.createReturnRequest(c,i,n);return r.value.unshift(a),a}finally{s.value=!1}}return{orders:t,returnRequests:r,isLoading:s,createOrder:e,createReturnRequest:o}});export{A as u};

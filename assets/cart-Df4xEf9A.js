import{C as L,A as h,x as m}from"./index-BQVMMhDG.js";import{u as I}from"./user-Cbv6_bUs.js";const f="elux_cart",u={async getCart(){return new Promise(t=>{setTimeout(()=>{t(this.loadFromLocal())},500)})},async addToCart(t,o,r){return new Promise(s=>{setTimeout(()=>{const a=this.loadFromLocal(),i=a.items.findIndex(e=>e.productId===t.id&&e.selectedVariant===r);i>-1?a.items[i].quantity+=o:a.items.push({productId:t.id,product:t,quantity:o,selectedVariant:r}),this.saveToLocal(a),s(a)},200)})},async removeFromCart(t,o){return new Promise(r=>{setTimeout(()=>{const s=this.loadFromLocal();s.items=s.items.filter(a=>!(a.productId===t&&a.selectedVariant===o)),this.saveToLocal(s),r(s)},200)})},async updateQuantity(t,o,r){return new Promise(s=>{setTimeout(()=>{const a=this.loadFromLocal(),i=a.items.find(e=>e.productId===t&&e.selectedVariant===r);i&&(i.quantity=o,i.quantity<=0&&(a.items=a.items.filter(e=>!(e.productId===t&&e.selectedVariant===r)))),this.saveToLocal(a),s(a)},200)})},async clearCart(){return new Promise(t=>{setTimeout(()=>{const o={items:[],total:0,totalQuantity:0};this.saveToLocal(o),t(o)},200)})},async calculateTotal(t,o){return new Promise(r=>{setTimeout(()=>{const s=t.reduce((i,e)=>{const y=o?e.product.priceWholesale:e.product.priceRetail;return i+y*e.quantity},0),a=t.reduce((i,e)=>i+e.quantity,0);r({total:s,totalQuantity:a})},100)})},saveToLocal(t){localStorage.setItem(f,JSON.stringify(t))},loadFromLocal(){const t=localStorage.getItem(f);return t?JSON.parse(t):{items:[],total:0,totalQuantity:0}}},g=L("cart",()=>{const t=m([]),o=m(0),r=m(0),s=m(!1),a=I(),i=u.loadFromLocal();i&&(t.value=i.items,c()),h(()=>a.isB2B,()=>{c()});function e(){s.value=!s.value}async function y(n,l=1,d,v=!0){const C=await u.addToCart(n,l,d);t.value=C.items,await c(),v&&(s.value=!0)}async function p(n,l){const d=await u.removeFromCart(n,l);t.value=d.items,await c()}async function T(n,l,d){const v=await u.updateQuantity(n,l,d);t.value=v.items,await c()}async function w(){const n=await u.clearCart();t.value=n.items,await c()}async function c(){const n=await u.calculateTotal(t.value,a.isB2B);o.value=n.total,r.value=n.totalQuantity,u.saveToLocal({items:t.value,total:o.value,totalQuantity:r.value})}return{items:t,total:o,totalQuantity:r,isOpen:s,toggleCart:e,addItem:y,removeItem:p,updateQuantity:T,clearCart:w,updateTotals:c}});export{g as u};

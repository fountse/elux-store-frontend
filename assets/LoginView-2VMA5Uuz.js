import{d as N,u as R,o as j,i as b,k as t,t as a,h as o,x as A,E as g,H as v,b as M,e as k,j as C,m as x,r as c,p as E,g as y,y as D,q as P}from"./index-7FrspKv6.js";import{u as $}from"./user-CfeTsN2J.js";const q={class:"flex items-center justify-center bg-page px-4 relative py-12"},H={class:"max-w-md w-full p-8"},F={class:"text-center mb-8"},G={class:"text-3xl font-bold text-text-primary mb-2"},I={class:"text-text-secondary"},J={class:"block text-sm font-medium text-text-secondary mb-2"},K={class:"flex justify-between items-center mb-2"},Q={class:"block text-sm font-medium text-text-secondary"},W={class:"block text-sm font-medium text-text-secondary mb-2"},X={class:"flex gap-4"},Y=["placeholder"],Z={key:0,class:"text-error text-sm text-center"},z=["disabled"],O={key:0,class:"animate-spin mr-2"},ee={class:"mt-4 text-center text-sm text-text-secondary"},te={class:"mr-1"},oe={class:"mt-6 text-center text-sm text-text-secondary"},ne=N({__name:"LoginView",setup(se){const{t:s}=R(),m=c(""),f=c(""),d=c(""),_=c(""),u=c(""),w=c(null),i=$(),V=P(),S=D(),h=()=>{const r=w.value;if(!r)return;const e=r.getContext("2d");if(!e)return;e.clearRect(0,0,r.width,r.height);const p="ABCDEFGHJKLMNPQRSTUVWXYZ23456789";let n="";for(let l=0;l<4;l++)n+=p.charAt(Math.floor(Math.random()*p.length));_.value=n,e.fillStyle="#f5f5f5",e.fillRect(0,0,r.width,r.height),e.font="24px Arial",e.textAlign="center",e.textBaseline="middle";for(let l=0;l<n.length;l++){const B=20+l*25,L=25,T=(Math.random()-.5)*.4;e.save(),e.translate(B,L),e.rotate(T),e.fillStyle=`rgb(${Math.floor(Math.random()*100)}, ${Math.floor(Math.random()*100)}, ${Math.floor(Math.random()*100)})`,e.fillText(n[l],0,0),e.restore()}e.strokeStyle="#ddd";for(let l=0;l<5;l++)e.beginPath(),e.moveTo(Math.random()*r.width,Math.random()*r.height),e.lineTo(Math.random()*r.width,Math.random()*r.height),e.stroke()};j(()=>{h()});const U=async()=>{if(u.value="",!m.value||!f.value){u.value="Please fill in all fields";return}if(!d.value||d.value.toUpperCase()!==_.value){u.value=s("login.captcha_error"),h(),d.value="";return}if(await i.login(m.value,f.value)){const e=S.query.redirect||"/";V.push(e)}};return(r,e)=>{const p=E("router-link");return y(),b("div",q,[t("div",H,[t("div",F,[t("h1",G,a(o(s)("login.welcome")),1),t("p",I,a(o(s)("login.subtitle")),1)]),t("form",{onSubmit:A(U,["prevent"]),class:"space-y-6"},[t("div",null,[t("label",J,a(o(s)("login.username")),1),g(t("input",{"onUpdate:modelValue":e[0]||(e[0]=n=>m.value=n),type:"text",class:"w-full bg-surface border border-border rounded-none px-4 py-3 text-text-primary placeholder:text-text-tertiary focus:border-text-primary focus:ring-0 focus:outline-none transition-colors",placeholder:"user or business"},null,512),[[v,m.value]])]),t("div",null,[t("div",K,[t("label",Q,a(o(s)("login.password")),1),M(p,{to:"/forgot-password",class:"text-sm text-accent hover:text-accent-hover font-medium"},{default:k(()=>[x(a(o(s)("login.forgot_password")),1)]),_:1})]),g(t("input",{"onUpdate:modelValue":e[1]||(e[1]=n=>f.value=n),type:"password",class:"w-full bg-surface border border-border rounded-none px-4 py-3 text-text-primary placeholder:text-text-tertiary focus:border-text-primary focus:ring-0 focus:outline-none transition-colors",placeholder:"123456"},null,512),[[v,f.value]])]),t("div",null,[t("label",W,a(o(s)("login.captcha")),1),t("div",X,[g(t("input",{"onUpdate:modelValue":e[2]||(e[2]=n=>d.value=n),type:"text",class:"flex-1 bg-surface border border-border rounded-none px-4 py-3 text-text-primary placeholder:text-text-tertiary focus:border-text-primary focus:ring-0 focus:outline-none transition-colors",placeholder:o(s)("login.captcha")},null,8,Y),[[v,d.value]]),t("canvas",{ref_key:"captchaCanvas",ref:w,width:"120",height:"50",class:"cursor-pointer rounded-none border border-border",onClick:h,title:"Click to refresh"},null,512)])]),u.value||o(i).error?(y(),b("div",Z,a(u.value||o(i).error),1)):C("",!0),t("button",{type:"submit",disabled:o(i).isLoading,class:"w-full bg-text-primary hover:opacity-90 text-bg-page font-bold py-3 rounded-none transition-all disabled:opacity-50 disabled:cursor-not-allowed flex justify-center"},[o(i).isLoading?(y(),b("span",O,"âšª")):C("",!0),x(" "+a(o(i).isLoading?o(s)("login.submitting"):o(s)("login.submit")),1)],8,z),t("div",ee,[t("span",te,a(o(s)("login.no_account")),1),M(p,{to:"/register",class:"text-accent hover:text-accent-hover font-medium"},{default:k(()=>[x(a(o(s)("login.register_now")),1)]),_:1})])],32),t("div",oe,[t("p",null,a(o(s)("login.demo_credentials"))+":",1),e[3]||(e[3]=t("p",null,[x("User: "),t("span",{class:"text-text-primary"},"user / 123456")],-1)),e[4]||(e[4]=t("p",null,[x("Business: "),t("span",{class:"text-text-primary"},"business / 123456")],-1))])])])}}});export{ne as default};

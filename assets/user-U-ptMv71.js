import{D as k,x as n,c}from"./index-C43oMqCu.js";const i={id:"u-001",username:"user",name:"Demo User",avatar:"https://ui-avatars.com/api/?name=Demo+User&background=0D8ABC&color=fff",role:"B2C",email:"user@elux.com"},y={id:"u-002",username:"business",name:"Acme Corp Admin",role:"B2B",enterpriseInfo:{companyName:"Acme Corp",address:"123 Business Rd",crn:"12345678",sic:"12345",bankAccount:"12345678",directorInfo:"John Doe",compliance:!0,ageVerify:!0,status:"verified"}},m={async login(e,o){return new Promise((r,s)=>{setTimeout(()=>{o==="123456"?e==="user"?r({token:"mock-token-customer",user:i}):e==="business"?r({token:"mock-token-business",user:y}):s(new Error("Invalid username")):s(new Error("Invalid password"))},800)})},async logout(){return new Promise(e=>{setTimeout(()=>e(),300)})},async getUserProfile(){return new Promise(e=>{setTimeout(()=>e(i),500)})}},U=k("user",()=>{const e=n("b2c"),o=n(null),r=n(localStorage.getItem("token")),s=n(!1),u=n(null),l=localStorage.getItem("user");if(l)try{o.value=JSON.parse(l)}catch(a){console.error("Failed to parse user from local storage",a),localStorage.removeItem("user")}else o.value={id:"u-001",username:"user",name:"Demo User",avatar:"https://ui-avatars.com/api/?name=Demo+User&background=0D8ABC&color=fff",role:"B2C",email:"user@elux.com",creditLimit:1e3,usedCredit:0,enterpriseInfo:{companyName:"Elux Tech Ltd.",address:"123 Tech Street, London, UK",crn:"12345678",sic:"62020",bankAccount:"Sort Code: 12-34-56, Account: 12345678",directorInfo:"John Doe, Director",compliance:!0,ageVerify:!0,status:"verified"}};const f=c(()=>e.value==="b2b"),v=c(()=>!!r.value);function d(){e.value=e.value==="b2c"?"b2b":"b2c"}function g(a){e.value=a}async function p(a,b){s.value=!0,u.value=null;try{const t=await m.login(a,b);return r.value=t.token,o.value=t.user,localStorage.setItem("token",t.token),localStorage.setItem("user",JSON.stringify(t.user)),o.value.role==="B2B"?e.value="b2b":e.value="b2c",!0}catch(t){return u.value=t.message,!1}finally{s.value=!1}}async function S(){await m.logout(),r.value=null,o.value=null,localStorage.removeItem("token"),localStorage.removeItem("user"),e.value="b2c"}return{userType:e,isB2B:f,user:o,token:r,isLoggedIn:v,isLoading:s,error:u,toggleUserType:d,setUserType:g,login:p,logout:S}});export{U as u};

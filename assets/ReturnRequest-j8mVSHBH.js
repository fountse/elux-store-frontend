import{d as D,u as O,m as T,a as A,w as y,v as P,x as u,o as l,i as e,b as S,j as I,t,f as n,g as d,F as V,r as $,q as H,h as g,E as G,H as J,n as K,l as Q,K as W,c as X,k as Y}from"./index-CEzz54Df.js";import{u as Z}from"./order-CQN3kDrI.js";import{P as ee}from"./PersonalCenterLayout-B6aGKgbL.js";import{_ as te}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./cart-Cuu-ZCK-.js";import"./user-BMqs4DLJ.js";const se={class:"flex flex-col gap-8 w-full max-w-5xl mx-auto font-sans text-black"},re={class:"flex justify-between items-center text-sm"},oe={class:"text-gray-500 tracking-wide"},ne={class:"text-black"},ae={key:0,class:"space-y-8 animate-fade-in"},le={class:"border-b border-gray-200 pb-6"},ce={class:"text-2xl font-bold mb-2"},de={class:"text-gray-500 text-sm"},ie={class:"space-y-4"},ue={class:"text-lg font-bold"},_e={class:"bg-white border border-gray-200 rounded-lg overflow-hidden"},fe={class:"p-4 border-b border-gray-100 bg-gray-50 flex items-center gap-4"},be=["checked"],ve={class:"text-sm font-medium"},he={class:"divide-y divide-gray-100"},ge=["onClick"],pe=["checked","onChange"],me={class:"w-20 h-20 bg-gray-100 flex-shrink-0 rounded-md overflow-hidden"},xe=["src"],ye={class:"flex-grow flex justify-between items-start"},ke={class:"font-bold text-base"},we={key:0,class:"text-sm text-gray-500 mt-1"},qe={class:"text-right"},Ce={class:"text-sm font-bold"},Re={class:"text-sm text-gray-500"},Se={key:0,class:"text-red-500 text-sm"},Ie={class:"space-y-4"},Ve={class:"text-lg font-bold"},$e={class:"relative"},je=["placeholder"],ze={class:"flex flex-wrap gap-2"},Be=["onClick"],Ee={key:0,class:"text-red-500 text-sm"},Le={class:"flex justify-end gap-4 pt-6 border-t border-gray-200"},Me=["disabled"],Ne={key:0},Fe={key:1},Ue={key:1,class:"text-center py-20"},De={class:"text-gray-500"},Oe={key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm animate-fade-in"},Te={class:"bg-white rounded-2xl max-w-md w-full p-8 text-center shadow-2xl transform transition-all scale-100"},Ae={class:"text-2xl font-bold mb-2"},Pe={class:"text-gray-500 mb-8"},He=D({__name:"ReturnRequest",setup(Ge){const{t:s}=O(),j=P(),m=Q(),k=Z(),c=u(void 0),w=u(!0),p=u(!1),x=u(!1),i=u(new Set),_=W({reason:""}),f=u(""),v=u(""),z=["size","quality","wrong_item","changed_mind","damaged","other"],h=r=>`${r.productId}-${r.selectedVariant||""}`,q=X(()=>c.value?c.value.items.every(r=>i.value.has(h(r))):!1),B=r=>r,E=r=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(r),L=()=>{c.value&&(q.value?i.value.clear():c.value.items.forEach(r=>{i.value.add(h(r))}),f.value="")},C=r=>{const o=h(r);i.value.has(o)?i.value.delete(o):i.value.add(o),f.value=""},M=r=>i.value.has(h(r)),N=r=>{_.reason=s(`return_request.reasons.${r}`),v.value=""},F=async()=>{let r=!0;if(f.value="",v.value="",i.value.size===0&&(f.value=s("return_request.error_select"),r=!1),_.reason.trim()||(v.value=s("return_request.error_reason"),r=!1),!!r){p.value=!0;try{if(!c.value)return;const o=c.value.items.filter(b=>i.value.has(h(b)));await k.createReturnRequest(c.value.id,o,_.reason),x.value=!0}catch(o){console.error("Failed to submit return request",o),alert(s("return_request.fail_message"))}finally{p.value=!1}}},U=()=>{x.value=!1,m.push("/user/returns")};return T(async()=>{const r=j.params.id;if(r){let o=k.orders.find(b=>b.id===r);c.value=o}w.value=!1}),(r,o)=>{const b=Y("router-link");return l(),A(ee,null,{default:y(()=>[e("div",se,[e("div",re,[e("div",oe,[S(b,{to:"/",class:"hover:text-black transition-colors"},{default:y(()=>[I(t(n(s)("nav.home")),1)]),_:1}),o[4]||(o[4]=e("span",{class:"mx-2"},"/",-1)),S(b,{to:"/user/orders",class:"hover:text-black transition-colors"},{default:y(()=>[I(t(n(s)("sidebar.orders")),1)]),_:1}),o[5]||(o[5]=e("span",{class:"mx-2"},"/",-1)),e("span",ne,t(n(s)("return_request.title")),1)])]),c.value?(l(),d("div",ae,[e("div",le,[e("h1",ce,t(n(s)("return_request.title")),1),e("p",de,t(n(s)("order.no"))+": "+t(c.value.id),1)]),e("section",ie,[e("h2",ue,t(n(s)("return_request.select_items")),1),e("div",_e,[e("div",fe,[e("input",{type:"checkbox",checked:q.value,onChange:L,class:"w-4 h-4 rounded border-gray-300 text-black focus:ring-black"},null,40,be),e("span",ve,t(n(s)("return_request.select_all")),1)]),e("div",he,[(l(!0),d(V,null,$(c.value.items,a=>(l(),d("div",{key:a.productId+a.selectedVariant,class:"p-4 flex gap-4 items-start hover:bg-gray-50 transition-colors cursor-pointer",onClick:R=>C(a)},[e("div",{class:"pt-1",onClick:o[0]||(o[0]=H(()=>{},["stop"]))},[e("input",{type:"checkbox",checked:M(a),onChange:R=>C(a),class:"w-4 h-4 rounded border-gray-300 text-black focus:ring-black"},null,40,pe)]),e("div",me,[e("img",{src:B(a.product.images[0]),class:"w-full h-full object-cover mix-blend-multiply"},null,8,xe)]),e("div",ye,[e("div",null,[e("h3",ke,t(a.product.name),1),a.selectedVariant?(l(),d("p",we,t(n(s)("common.spec"))+": "+t(a.selectedVariant),1)):g("",!0)]),e("div",qe,[e("p",Ce,t(E(a.product.priceRetail)),1),e("span",Re,"x"+t(a.quantity),1)])])],8,ge))),128))])]),f.value?(l(),d("p",Se,t(f.value),1)):g("",!0)]),e("section",Ie,[e("h2",Ve,t(n(s)("return_request.reason_title")),1),e("div",$e,[G(e("textarea",{"onUpdate:modelValue":o[1]||(o[1]=a=>_.reason=a),rows:"4",class:"w-full p-4 border border-gray-200 rounded-lg focus:ring-1 focus:ring-black focus:border-black outline-none resize-none bg-gray-50",placeholder:n(s)("return_request.reason_placeholder")},null,8,je),[[J,_.reason]])]),e("div",ze,[(l(),d(V,null,$(z,a=>e("button",{key:a,type:"button",onClick:R=>N(a),class:K(["px-3 py-1.5 rounded-full text-xs border transition-all duration-200",_.reason===n(s)(`return_request.reasons.${a}`)?"bg-gray-100 text-black border-gray-400 font-bold":"bg-white text-gray-500 border-gray-200 hover:border-gray-400"])},t(n(s)(`return_request.reasons.${a}`)),11,Be)),64))]),v.value?(l(),d("p",Ee,t(v.value),1)):g("",!0)]),e("div",Le,[e("button",{onClick:o[2]||(o[2]=a=>n(m).back()),class:"px-8 py-3 rounded-lg border border-gray-300 hover:bg-gray-50 transition-colors font-medium"},t(n(s)("common.cancel")),1),e("button",{onClick:F,class:"px-8 py-3 rounded-lg bg-black text-white hover:bg-gray-800 transition-colors font-bold shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",disabled:p.value},[p.value?(l(),d("span",Ne,t(n(s)("return_request.processing")),1)):(l(),d("span",Fe,t(n(s)("return_request.submit_btn")),1))],8,Me)])])):w.value?g("",!0):(l(),d("div",Ue,[e("p",De,t(n(s)("return_request.not_found")),1),e("button",{onClick:o[3]||(o[3]=a=>n(m).push("/user/orders")),class:"mt-4 text-black underline"},t(n(s)("return_request.back_orders")),1)]))]),x.value?(l(),d("div",Oe,[e("div",Te,[o[6]||(o[6]=e("div",{class:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-8 h-8 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})])],-1)),e("h3",Ae,t(n(s)("return_request.success_title")),1),e("p",Pe,t(n(s)("return_request.success_desc")),1),e("button",{onClick:U,class:"w-full py-3 bg-black text-white rounded-xl font-bold hover:bg-gray-800 transition-colors"},t(n(s)("return_request.view_status")),1)])])):g("",!0)]),_:1})}}}),Ze=te(He,[["__scopeId","data-v-cfb05a87"]]);export{Ze as default};
